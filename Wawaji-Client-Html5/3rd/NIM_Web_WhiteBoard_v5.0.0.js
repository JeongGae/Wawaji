!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WhiteBoard=t():e.WhiteBoard=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};n(41);var o=n(239),r=n(240),s=n(256),a=n(254),c=n(116),l=n(13),u=n(241),h=n(242),p=n(243),d=i({},l.constantBB,{install:function(e,t){o.install(e,t),r.install(e,t),e.parser.mixin({configMap:u,serializeMap:h,unserializeMap:p})},use:function(e){c.use(e)},getInstance:function(e){return new a(e)},destroy:function(e){e&&(e.destroy(),e=null)},checkCompatibility:function(){return s()}});e.exports=d},2:function(e,t,n){(function(t){"use strict";var n="'6961952b80ae4f77e35732c18ecce0e659a1c4a0",i="6961952'",o="5.0.0",r="2.6.0.328",s="3.9.0",a="47",c="1",l=1,u="https://lbs.netease.im/lbs/webconf.jsp",h="roomserver.netease.im",p="https://dr.netease.im/1.gif",d="development"===t.env.NODE_ENV?6e3:42e3,f={info:{hash:n,shortHash:i,version:o,sdkVersion:a,nrtcVersion:s,nrtcSdkVersion:c,protocolVersion:l},agentVersion:r,lbsUrl:u,roomserver:h,connectTimeout:d,xhrTimeout:d,socketTimeout:d,reconnectionDelay:656.25,reconnectionDelayMax:d,reconnectionJitter:.1,heartbeatInterval:18e4,cmdTimeout:d,defaultReportUrl:p};f.formatSocketUrl=function(e){var t=e.url,n=e.secure,i=n?"https":"http";return t.indexOf("http")===-1?i+"://"+t:t},f.uploadUrl="https://nos.netease.com",f.replaceUrl="https://{bucket}.nosdn.127.net/{object}",f.downloadHost="nos.netease.com",f.downloadUrl="https://{bucket}.nosdn.127.net/{object}",f.httpsEnabled=!1,f.genUploadUrl=function(e){return f.uploadUrl+"/"+e},f.genDownloadUrl=function(e,t){var n=f.replaceUrl;return/^http/.test(n)?f.httpsEnabled&&(n=n.replace("http","https")):n=f.httpsEnabled?"https://"+n:"http://"+n,n.replace("{bucket}",e).replace("{object}",t)},e.exports=f}).call(t,n(8))},3:function(e,t,n){(function(t,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.0.5
	 */
!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function o(e){return"function"==typeof e}function r(e){$=e}function s(e){Q=e}function a(){return function(){return t.nextTick(p)}}function c(){return"undefined"!=typeof z?function(){z(p)}:h()}function l(){var e=0,t=new Z(p),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function u(){var e=new MessageChannel;return e.port1.onmessage=p,function(){return e.port2.postMessage(0)}}function h(){var e=setTimeout;return function(){return e(p,1)}}function p(){for(var e=0;e<J;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}J=0}function d(){try{var e=n(26);return z=e.runOnLoop||e.runOnContext,c()}catch(t){return h()}}function f(e,t){var n=arguments,i=this,o=new this.constructor(g);void 0===o[oe]&&R(o);var r=i._state;return r?!function(){var e=n[r-1];Q(function(){return D(r,o,e,i._result)})}():E(i,o,e,t),o}function b(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(g);return T(n,e),n}function g(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function _(e){try{return e.then}catch(t){return ce.error=t,ce}}function v(e,t,n,i){try{e.call(t,n,i)}catch(o){return o}}function w(e,t,n){Q(function(e){var i=!1,o=v(n,t,function(n){i||(i=!0,t!==n?T(e,n):S(e,n))},function(t){i||(i=!0,I(e,t))},"Settle: "+(e._label||" unknown promise"));!i&&o&&(i=!0,I(e,o))},e)}function C(e,t){t._state===se?S(e,t._result):t._state===ae?I(e,t._result):E(t,void 0,function(t){return T(e,t)},function(t){return I(e,t)})}function O(e,t,n){t.constructor===e.constructor&&n===f&&t.constructor.resolve===b?C(e,t):n===ce?I(e,ce.error):void 0===n?S(e,t):o(n)?w(e,t,n):S(e,t)}function T(t,n){t===n?I(t,m()):e(n)?O(t,n,_(n)):S(t,n)}function A(e){e._onerror&&e._onerror(e._result),M(e)}function S(e,t){e._state===re&&(e._result=t,e._state=se,0!==e._subscribers.length&&Q(M,e))}function I(e,t){e._state===re&&(e._state=ae,e._result=t,Q(A,e))}function E(e,t,n,i){var o=e._subscribers,r=o.length;e._onerror=null,o[r]=t,o[r+se]=n,o[r+ae]=i,0===r&&e._state&&Q(M,e)}function M(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,o=void 0,r=e._result,s=0;s<t.length;s+=3)i=t[s],o=t[s+n],i?D(n,i,o,r):o(r);e._subscribers.length=0}}function N(){this.error=null}function P(e,t){try{return e(t)}catch(n){return le.error=n,le}}function D(e,t,n,i){var r=o(n),s=void 0,a=void 0,c=void 0,l=void 0;if(r){if(s=P(n,i),s===le?(l=!0,a=s.error,s=null):c=!0,t===s)return void I(t,y())}else s=i,c=!0;t._state!==re||(r&&c?T(t,s):l?I(t,a):e===se?S(t,s):e===ae&&I(t,s))}function j(e,t){try{t(function(t){T(e,t)},function(t){I(e,t)})}catch(n){I(e,n)}}function x(){return ue++}function R(e){e[oe]=ue++,e._state=void 0,e._result=void 0,e._subscribers=[]}function L(e,t){this._instanceConstructor=e,this.promise=new e(g),this.promise[oe]||R(this.promise),G(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&S(this.promise,this._result))):I(this.promise,k())}function k(){return new Error("Array Methods must be provided an Array")}function W(e){return new L(this,e).promise}function U(e){var t=this;return new t(G(e)?function(n,i){for(var o=e.length,r=0;r<o;r++)t.resolve(e[r]).then(n,i)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function B(e){var t=this,n=new t(g);return I(n,e),n}function H(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Y(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(e){this[oe]=x(),this._result=this._state=void 0,this._subscribers=[],g!==e&&("function"!=typeof e&&H(),this instanceof F?j(this,e):Y())}function V(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var o=null;try{o=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===o&&!n.cast)return}e.Promise=F}var K=void 0;K=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G=K,J=0,z=void 0,$=void 0,Q=function(e,t){ne[J]=e,ne[J+1]=t,J+=2,2===J&&($?$(p):ie())},X="undefined"!=typeof window?window:void 0,q=X||{},Z=q.MutationObserver||q.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof t&&"[object process]"==={}.toString.call(t),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),ie=void 0;ie=ee?a():Z?l():te?u():void 0===X?d():h();var oe=Math.random().toString(36).substring(16),re=void 0,se=1,ae=2,ce=new N,le=new N,ue=0;return L.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===re&&n<e;n++)this._eachEntry(t[n],n)},L.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===b){var o=_(e);if(o===f&&e._state!==re)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===F){var r=new n(g);O(r,e,o),this._willSettleAt(r,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},L.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===re&&(this._remaining--,e===ae?I(i,n):this._result[t]=n),0===this._remaining&&S(i,this._result)},L.prototype._willSettleAt=function(e,t){var n=this;E(e,void 0,function(e){return n._settledAt(se,t,e)},function(e){return n._settledAt(ae,t,e)})},F.all=W,F.race=U,F.resolve=b,F.reject=B,F._setScheduler=r,F._setAsap=s,F._asap=Q,F.prototype={constructor:F,then:f,"catch":function(e){return this.then(null,e)}},F.polyfill=V,F.Promise=F,F})}).call(t,n(8),function(){return this}())},4:function(e,t,n){"use strict";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(){this._events=new i,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),r.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)s.call(e,t)&&n.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},r.prototype.listeners=function(e,t){var n=a?a+e:e,i=this._events[n];if(t)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var o=0,r=i.length,s=new Array(r);o<r;o++)s[o]=i[o].fn;return s},r.prototype.emit=function(e,t,n,i,o,r){var s=a?a+e:e;if(!this._events[s])return!1;var c,l,u=this._events[s],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,r),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var p,d=u.length;for(l=0;l<d;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,i);break;default:if(!c)for(p=1,c=new Array(h-1);p<h;p++)c[p-1]=arguments[p];u[l].fn.apply(u[l].context,c)}}return!0},r.prototype.on=function(e,t,n){var i=new o(t,n||this),r=a?a+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.once=function(e,t,n){var i=new o(t,n||this,!0),r=a?a+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.removeListener=function(e,t,n,o){var r=a?a+e:e;if(!this._events[r])return this;if(!t)return 0===--this._eventsCount?this._events=new i:delete this._events[r],this;var s=this._events[r];if(s.fn)s.fn!==t||o&&!s.once||n&&s.context!==n||(0===--this._eventsCount?this._events=new i:delete this._events[r]);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==t||o&&!s[c].once||n&&s[c].context!==n)&&l.push(s[c]);l.length?this._events[r]=1===l.length?l[0]:l:0===--this._eventsCount?this._events=new i:delete this._events[r]}return this},r.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new i:delete this._events[t])):(this._events=new i,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=a,r.EventEmitter=r,e.exports=r},8:function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function r(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){b&&d&&(b=!1,d.length?f=d.concat(f):g=-1,f.length&&a())}function a(){if(!b){var e=o(s);b=!0;for(var t=f.length;t;){for(d=f,f=[];++g<t;)d&&d[g].run();g=-1,t=f.length}d=null,b=!1,r(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var u,h,p=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var d,f=[],b=!1,g=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||b||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},9:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=n(38);Object.defineProperty(t,"ajax",{enumerable:!0,get:function(){return i(o)["default"]}});var r=n(47);Object.defineProperty(t,"element",{enumerable:!0,get:function(){return i(r)["default"]}});var s=n(39);Object.defineProperty(t,"tool",{enumerable:!0,get:function(){return i(s)["default"]}})},10:function(e,t,n){var i;(function(e,o){(function(){"use strict";function r(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function s(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=c(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function a(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=w)for(;++n<i;)t(e[n],n,e);else l(e,t)}function c(e){return e=f(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:r(e)}function l(e,t){for(var n in e)T.call(e,n)&&t(e[n],n,e)}function u(e){return null==e?r(e):A.call(e).slice(8,-1)}function h(e,t){var n=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(n)||"object"==n&&!e[t])}function p(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function d(e,t){var n=null;return a(e,function(i,o){n=t(n,i,o,e)}),n}function f(e){return String(e).replace(/^ +| +$/g,"")}function b(e){function t(t){return d(t,function(t,n){return t||RegExp("\\b"+(n.pattern||p(n))+"\\b","i").exec(e)&&(n.label||n)})}function n(t){return d(t,function(t,n,i){return t||(n[G]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(G)]||RegExp("\\b"+p(i)+"(?:\\b|\\w*\\d)","i").exec(e))&&i})}function i(t){return d(t,function(t,n){return t||RegExp("\\b"+(n.pattern||p(n))+"\\b","i").exec(e)&&(n.label||n)})}function o(t){return d(t,function(t,n){var i=n.pattern||p(n);return!t&&(t=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=s(t,i,n.label||n)),t})}function r(t){return d(t,function(t,n){var i=n.pattern||p(n);return!t&&(t=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),n=n.label||n,t=c(t[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function a(t){return d(t,function(t,n){return t||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}function g(){return this.description||""}var y=m,_=e&&"object"==typeof e&&"String"!=u(e);_&&(y=e,e=null);var v=y.navigator||{},w=v.userAgent||"";e||(e=w);var O,T,S=_?!!v.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(A.toString()),I="Object",E=_?I:"ScriptBridgingProxyObject",M=_?I:"Environment",N=_&&y.java?"JavaPackage":u(y.java),P=_?I:"RuntimeObject",D=/\bJava/.test(N)&&y.java,j=D&&u(y.environment)==M,x=D?"a":"α",R=D?"b":"β",L=y.document||{},k=y.operamini||y.opera,W=C.test(W=_&&k?k["[[Class]]"]:u(k))?W:k=null,U=e,B=[],H=null,Y=e==w,F=Y&&k&&"function"==typeof k.version&&k.version(),V=t([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),K=i(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),G=r([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),J=n({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),z=o(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(V&&(V=[V]),J&&!G&&(G=r([J])),(O=/\bGoogle TV\b/.exec(G))&&(G=O[0]),/\bSimulator\b/i.test(e)&&(G=(G?G+" ":"")+"Simulator"),"Opera Mini"==K&&/\bOPiOS\b/.test(e)&&B.push("running in Turbo/Uncompressed mode"),"IE"==K&&/\blike iPhone OS\b/.test(e)?(O=b(e.replace(/like iPhone OS/,"")),J=O.manufacturer,G=O.product):/^iP/.test(G)?(K||(K="Safari"),z="iOS"+((O=/ OS ([\d_]+)/i.exec(e))?" "+O[1].replace(/_/g,"."):"")):"Konqueror"!=K||/buntu/i.test(z)?J&&"Google"!=J&&(/Chrome/.test(K)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(G))||/\bAndroid\b/.test(z)&&/^Chrome/.test(K)&&/\bVersion\//i.test(e)?(K="Android Browser",z=/\bAndroid\b/.test(z)?z:"Android"):"Silk"==K?(/\bMobi/i.test(e)||(z="Android",B.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&B.unshift("accelerated")):"PaleMoon"==K&&(O=/\bFirefox\/([\d.]+)\b/.exec(e))?B.push("identifying as Firefox "+O[1]):"Firefox"==K&&(O=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(z||(z="Firefox OS"),G||(G=O[1])):!K||(O=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(K))?(K&&!G&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(O+"/")+8))&&(K=null),(O=G||J||z)&&(G||J||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(z))&&(K=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(z)?z:O)+" Browser")):"Electron"==K&&(O=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&B.push("Chromium "+O):z="Kubuntu",F||(F=a(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",p(K),"(?:Firefox|Minefield|NetFront)"])),(O="iCab"==V&&parseFloat(F)>3&&"WebKit"||/\bOpera\b/.test(K)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(V)&&"WebKit"||!V&&/\bMSIE\b/i.test(e)&&("Mac OS"==z?"Tasman":"Trident")||"WebKit"==V&&/\bPlayStation\b(?! Vita\b)/i.test(K)&&"NetFront")&&(V=[O]),"IE"==K&&(O=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(K+=" Mobile",z="Windows Phone "+(/\+$/.test(O)?O:O+".x"),B.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(K="IE Mobile",z="Windows Phone 8.x",B.unshift("desktop mode"),F||(F=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=K&&"Trident"==V&&(O=/\brv:([\d.]+)/.exec(e))&&(K&&B.push("identifying as "+K+(F?" "+F:"")),K="IE",F=O[1]),Y){if(h(y,"global"))if(D&&(O=D.lang.System,U=O.getProperty("os.arch"),z=z||O.getProperty("os.name")+" "+O.getProperty("os.version")),j){try{F=y.require("ringo/engine").version.join("."),K="RingoJS"}catch($){(O=y.system)&&O.global.system==y.system&&(K="Narwhal",z||(z=O[0].os||null))}K||(K="Rhino")}else"object"==typeof y.process&&!y.process.browser&&(O=y.process)&&("object"==typeof O.versions&&("string"==typeof O.versions.electron?(B.push("Node "+O.versions.node),K="Electron",F=O.versions.electron):"string"==typeof O.versions.nw&&(B.push("Chromium "+F,"Node "+O.versions.node),K="NW.js",F=O.versions.nw)),K||(K="Node.js",U=O.arch,z=O.platform,F=/[\d.]+/.exec(O.version),F=F?F[0]:null));else u(O=y.runtime)==E?(K="Adobe AIR",z=O.flash.system.Capabilities.os):u(O=y.phantom)==P?(K="PhantomJS",F=(O=O.version||null)&&O.major+"."+O.minor+"."+O.patch):"number"==typeof L.documentMode&&(O=/\bTrident\/(\d+)/i.exec(e))?(F=[F,L.documentMode],(O=+O[1]+4)!=F[1]&&(B.push("IE "+F[1]+" mode"),V&&(V[1]=""),F[1]=O),F="IE"==K?String(F[1].toFixed(1)):F[0]):"number"==typeof L.documentMode&&/^(?:Chrome|Firefox)\b/.test(K)&&(B.push("masking as "+K+" "+F),K="IE",F="11.0",V=["Trident"],z="Windows");z=z&&c(z)}if(F&&(O=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(F)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(Y&&v.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(H=/b/i.test(O)?"beta":"alpha",F=F.replace(RegExp(O+"\\+?$"),"")+("beta"==H?R:x)+(/\d+\+?/.exec(O)||"")),"Fennec"==K||"Firefox"==K&&/\b(?:Android|Firefox OS)\b/.test(z))K="Firefox Mobile";else if("Maxthon"==K&&F)F=F.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(G))"Xbox 360"==G&&(z=null),"Xbox 360"==G&&/\bIEMobile\b/.test(e)&&B.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(K)&&(!K||G||/Browser|Mobi/.test(K))||"Windows CE"!=z&&!/Mobi/i.test(e))if("IE"==K&&Y)try{null===y.external&&B.unshift("platform preview")}catch($){B.unshift("embedded")}else(/\bBlackBerry\b/.test(G)||/\bBB10\b/.test(e))&&(O=(RegExp(G.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||F)?(O=[O,/BB10/.test(e)],z=(O[1]?(G=null,J="BlackBerry"):"Device Software")+" "+O[0],F=null):this!=l&&"Wii"!=G&&(Y&&k||/Opera/.test(K)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==K&&/\bOS X (?:\d+\.){2,}/.test(z)||"IE"==K&&(z&&!/^Win/.test(z)&&F>5.5||/\bWindows XP\b/.test(z)&&F>8||8==F&&!/\bTrident\b/.test(e)))&&!C.test(O=b.call(l,e.replace(C,"")+";"))&&O.name&&(O="ing as "+O.name+((O=O.version)?" "+O:""),C.test(K)?(/\bIE\b/.test(O)&&"Mac OS"==z&&(z=null),O="identify"+O):(O="mask"+O,K=W?c(W.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(O)&&(z=null),Y||(F=null)),V=["Presto"],B.push(O));else K+=" Mobile";(O=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(O=[parseFloat(O.replace(/\.(\d)$/,".0$1")),O],"Safari"==K&&"+"==O[1].slice(-1)?(K="WebKit Nightly",H="alpha",F=O[1].slice(0,-1)):F!=O[1]&&F!=(O[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(F=null),O[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==O[0]&&537.36==O[2]&&parseFloat(O[1])>=28&&"WebKit"==V&&(V=["Blink"]),Y&&(S||O[1])?(V&&(V[1]="like Chrome"),O=O[1]||(O=O[0],O<530?1:O<532?2:O<532.05?3:O<533?4:O<534.03?5:O<534.07?6:O<534.1?7:O<534.13?8:O<534.16?9:O<534.24?10:O<534.3?11:O<535.01?12:O<535.02?"13+":O<535.07?15:O<535.11?16:O<535.19?17:O<536.05?18:O<536.1?19:O<537.01?20:O<537.11?"21+":O<537.13?23:O<537.18?24:O<537.24?25:O<537.36?26:"Blink"!=V?"27":"28")):(V&&(V[1]="like Safari"),O=O[0],O=O<400?1:O<500?2:O<526?3:O<533?4:O<534?"4+":O<535?5:O<537?6:O<538?7:O<601?8:"8"),V&&(V[1]+=" "+(O+="number"==typeof O?".x":/[.+]/.test(O)?"":"+")),"Safari"==K&&(!F||parseInt(F)>45)&&(F=O)),"Opera"==K&&(O=/\bzbov|zvav$/.exec(z))?(K+=" ",B.unshift("desktop mode"),"zvav"==O?(K+="Mini",F=null):K+="Mobile",z=z.replace(RegExp(" *"+O+"$"),"")):"Safari"==K&&/\bChrome\b/.exec(V&&V[1])&&(B.unshift("desktop mode"),K="Chrome Mobile",F=null,/\bOS X\b/.test(z)?(J="Apple",z="iOS 4.3+"):z=null),F&&0==F.indexOf(O=/[\d.]+$/.exec(z))&&e.indexOf("/"+O+"-")>-1&&(z=f(z.replace(O,""))),V&&!/\b(?:Avant|Nook)\b/.test(K)&&(/Browser|Lunascape|Maxthon/.test(K)||"Safari"!=K&&/^iOS/.test(z)&&/\bSafari\b/.test(V[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(K)&&V[1])&&(O=V[V.length-1])&&B.push(O),B.length&&(B=["("+B.join("; ")+")"]),J&&G&&G.indexOf(J)<0&&B.push("on "+J),G&&B.push((/^on /.test(B[B.length-1])?"":"on ")+G),z&&(O=/ ([\d.+]+)$/.exec(z),T=O&&"/"==z.charAt(z.length-O[0].length-1),z={architecture:32,family:O&&!T?z.replace(O[0],""):z,version:O?O[1]:null,toString:function(){var e=this.version;return this.family+(e&&!T?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(O=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(U))&&!/\bi686\b/i.test(U)?(z&&(z.architecture=64,z.family=z.family.replace(RegExp(" *"+O),"")),K&&(/\bWOW64\b/i.test(e)||Y&&/\w(?:86|32)$/.test(v.cpuClass||v.platform)&&!/\bWin64; x64\b/i.test(e))&&B.unshift("32-bit")):z&&/^OS X/.test(z.family)&&"Chrome"==K&&parseFloat(F)>=39&&(z.architecture=64),e||(e=null);var Q={};return Q.description=e,Q.layout=V&&V[0],Q.manufacturer=J,Q.name=K,Q.prerelease=H,Q.product=G,Q.ua=e,Q.version=K&&F,Q.os=z||{architecture:null,family:null,version:null,toString:function(){return"null"}},Q.parse=b,Q.toString=g,Q.version&&B.unshift(F),Q.name&&B.unshift(K),z&&K&&(z!=String(z).split(" ")[0]||z!=K.split(" ")[0]&&!G)&&B.push(G?"("+z+")":"on "+z),B.length&&(Q.description=B.join(" ")),Q}var g={"function":!0,object:!0},m=g[typeof window]&&window||this,y=g[typeof t]&&t,_=g[typeof e]&&e&&!e.nodeType&&e,v=y&&_&&"object"==typeof o&&o;!v||v.global!==v&&v.window!==v&&v.self!==v||(m=v);var w=Math.pow(2,53)-1,C=/\bOpera/,O=Object.prototype,T=O.hasOwnProperty,A=O.toString,S=b();m.platform=S,i=function(){return S}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}).call(this)}).call(t,n(15)(e),function(){return this}())},13:function(e,t){"use strict";t.__esModule=!0;var n,i,o,r,s={CONTROL_COMMAND_BUSY:9,CONTROL_COMMAND_SELF_ON_BACKGROUND:12,CONTROL_COMMAND_START_NOTIFY_RECEIVED:13},a={NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_ON:1,NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_OFF:2,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_ON:3,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_OFF:4,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO:5,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_AGREE:6,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_REJECT:7,NETCALL_CONTROL_COMMAND_SWITCH_VIDEO_TO_AUDIO:8,NETCALL_CONTROL_COMMAND_BUSY:9,NETCALL_CONTROL_COMMAND_SELF_CAMERA_INVALID:10,NETCALL_CONTROL_COMMAND_SELF_AUDIO_INVALID:11,NETCALL_CONTROL_COMMAND_SELF_ON_BACKGROUND:12,NETCALL_CONTROL_COMMAND_START_NOTIFY_RECEIVED:13,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_START:14,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_STOP:15},c={HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1},l={NETCALL_TYPE_AUDIO:1,NETCALL_TYPE_VIDEO:2,DEVICE_TYPE_AUDIO_IN:0,DEVICE_TYPE_AUDIO_OUT_LOCAL:1,DEVICE_TYPE_AUDIO_OUT_CHAT:2,DEVICE_TYPE_VIDEO:3,DEVICE_TYPE_DESKTOP_SCREEN:4,DEVICE_TYPE_DESKTOP_WINDOW:5,CHAT_VIDEO_QUALITY_NORMAL:0,CHAT_VIDEO_QUALITY_LOW:1,CHAT_VIDEO_QUALITY_MEDIUM:2,CHAT_VIDEO_QUALITY_HIGH:3,CHAT_VIDEO_QUALITY_480P:4,CHAT_VIDEO_QUALITY_540P:5,CHAT_VIDEO_QUALITY_720P:6,CHAT_VIDEO_FRAME_RATE_NORMAL:0,CHAT_VIDEO_FRAME_RATE_5:1,CHAT_VIDEO_FRAME_RATE_10:2,CHAT_VIDEO_FRAME_RATE_15:3,CHAT_VIDEO_FRAME_RATE_20:4,CHAT_VIDEO_FRAME_RATE_25:5,LAYOUT_SPLITBOTTOMHORFLOATING:0,LAYOUT_SPLITTOPHORFLOATING:1,LAYOUT_SPLITLATTICETILE:2,LAYOUT_SPLITLATTICECUTTINGTILE:3,LAYOUT_SPLITCUSTOM:4,ROLE_PLAYER:0,ROLE_AUDIENCE:1},u={WB_TYPE_TCP:2,WB_TYPE_UDP:3,CALL_TYPE_NONE:0,CALL_TYPE_AUDIO:1,HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1};l.deviceTypeMap=(n={},n[l.DEVICE_TYPE_AUDIO_IN]="audioIn",n[l.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",n[l.DEVICE_TYPE_VIDEO]="video",n),l.deviceTypeMap=(i={},i[l.DEVICE_TYPE_AUDIO_IN]="audioIn",i[l.DEVICE_TYPE_AUDIO_OUT_LOCAL]="audioOut",i[l.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",i[l.DEVICE_TYPE_VIDEO]="video",i),l.videoMap={frame:(o={},o[l.CHAT_VIDEO_QUALITY_NORMAL]="480x320",o[l.CHAT_VIDEO_QUALITY_LOW]="176x144",o[l.CHAT_VIDEO_QUALITY_MEDIUM]="352x288",o[l.CHAT_VIDEO_QUALITY_HIGH]="480x320",o[l.CHAT_VIDEO_QUALITY_480P]="640x480",o[l.CHAT_VIDEO_QUALITY_540P]="960x540",o[l.CHAT_VIDEO_QUALITY_720P]="1280x720",o),frameRate:(r={},r[l.CHAT_VIDEO_FRAME_RATE_NORMAL]=15,r[l.CHAT_VIDEO_FRAME_RATE_5]=5,r[l.CHAT_VIDEO_FRAME_RATE_10]=10,r[l.CHAT_VIDEO_FRAME_RATE_15]=15,r[l.CHAT_VIDEO_FRAME_RATE_20]=20,r[l.CHAT_VIDEO_FRAME_RATE_25]=25,r)};var h={getVideoSessionConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.quality,n=void 0===t?l.CHAT_VIDEO_QUALITY_NORMAL:t,i=e.frameRate,o=void 0===i?l.CHAT_VIDEO_FRAME_RATE_NORMAL:i,r={},s=l.videoMap.frame[n];return r.frameRate=l.videoMap.frameRate[o],r.width=+s.split("x")[0],r.height=+s.split("x")[1],r},getDeviceTypeStr:function(e){return l.deviceTypeMap[e]},getDeviceTypeMap:function(e){return l.deviceTypeMap[e]}},p=Object.assign(l,a,c),d=Object.assign(u,s,c);t.constantTool=h,t.constantRtc=p,t.constantBB=d},15:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},16:function(e,t){"use strict";t.__esModule=!0;var n,i,o={CURRENT:{SDK_TYPE:null},SDK_TYPE:{NETCALL:1,WEBRTC:2,WHITEBOARD:3,NRTC:4},SDK_NAME:{1:"Netcall",2:"WebRTC",3:"WhiteBoard",4:"NRTC"}};o.STATS_FUN=(n={},n[o.SDK_TYPE.NETCALL]=1,n[o.SDK_TYPE.WEBRTC]=1,n[o.SDK_TYPE.NRTC]=1,n[o.SDK_TYPE.WHITEBOARD]=0,n),o.STATS_RTC=(i={},i[o.SDK_TYPE.WEBRTC]=1,i[o.SDK_TYPE.NRTC]=1,i[o.SDK_TYPE.WHITEBOARD]=0,i),t["default"]=o,e.exports=t["default"]},25:function(e,t,n){var i,o;!function(r,s){"use strict";i=s,o="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==o&&(e.exports=o))}(this,function(){var e,t,n,i,o=Function.call,r=Object.prototype,s=o.bind(r.hasOwnProperty),a=o.bind(r.propertyIsEnumerable),c=o.bind(r.toString),l=s(r,"__defineGetter__");l&&(e=o.bind(r.__defineGetter__),t=o.bind(r.__defineSetter__),n=o.bind(r.__lookupGetter__),i=o.bind(r.__lookupSetter__));var u=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e};Object.getPrototypeOf||(Object.getPrototypeOf=function(e){var t=e.__proto__;return t||null===t?t:"[object Function]"===c(e.constructor)?e.constructor.prototype:e instanceof Object?r:null});var h=function(e){try{return e.sentinel=0,0===Object.getOwnPropertyDescriptor(e,"sentinel").value}catch(t){return!1}};if(Object.defineProperty){var p=h({}),d="undefined"==typeof document||h(document.createElement("div"));if(!d||!p)var f=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||f){var b="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(e,t){if(u(e))throw new TypeError(b+e);if(f)try{return f.call(Object,e,t)}catch(o){}var c;if(!s(e,t))return c;if(c={enumerable:a(e,t),configurable:!0},l){var h=e.__proto__,p=e!==r;p&&(e.__proto__=r);var d=n(e,t),g=i(e,t);if(p&&(e.__proto__=h),d||g)return d&&(c.get=d),g&&(c.set=g),c}return c.value=e[t],c.writable=!0,c}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),!Object.create){var g,m=!({__proto__:null}instanceof Object),y=function(){if(!document.domain)return!1;try{return!!new ActiveXObject("htmlfile")}catch(e){return!1}},_=function(){var e,t;t=new ActiveXObject("htmlfile");var n="script";return t.write("<"+n+"></"+n+">"),t.close(),e=t.parentWindow.Object.prototype,t=null,e},v=function(){var e,t=document.createElement("iframe"),n=document.body||document.documentElement;return t.style.display="none",n.appendChild(t),t.src="javascript:",e=t.contentWindow.Object.prototype,n.removeChild(t),t=null,e};g=m||"undefined"==typeof document?function(){return{__proto__:null}}:function(){var e=y()?_():v();delete e.constructor,delete e.hasOwnProperty,delete e.propertyIsEnumerable,delete e.isPrototypeOf,delete e.toLocaleString,delete e.toString,delete e.valueOf;var t=function(){};return t.prototype=e,g=function(){return new t},new t},Object.create=function(e,t){var n,i=function(){};if(null===e)n=g();else{if(null!==e&&u(e))throw new TypeError("Object prototype may only be an Object or null");i.prototype=e,n=new i,n.__proto__=e}return void 0!==t&&Object.defineProperties(n,t),n}}var w=function(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){return!1}};if(Object.defineProperty){var C=w({}),O="undefined"==typeof document||w(document.createElement("div"));if(!C||!O)var T=Object.defineProperty,A=Object.defineProperties}if(!Object.defineProperty||T){var S="Property description must be an object: ",I="Object.defineProperty called on non-object: ",E="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(o,s,a){if(u(o))throw new TypeError(I+o);if(u(a))throw new TypeError(S+a);if(T)try{return T.call(Object,o,s,a)}catch(c){}if("value"in a)if(l&&(n(o,s)||i(o,s))){var h=o.__proto__;o.__proto__=r,delete o[s],
o[s]=a.value,o.__proto__=h}else o[s]=a.value;else{var p="get"in a,d="set"in a;if(!l&&(p||d))throw new TypeError(E);p&&e(o,s,a.get),d&&t(o,s,a.set)}return o}}Object.defineProperties&&!A||(Object.defineProperties=function(e,t){if(A)try{return A.call(Object,e,t)}catch(n){}return Object.keys(t).forEach(function(n){"__proto__"!==n&&Object.defineProperty(e,n,t[n])}),e}),Object.seal||(Object.seal=function(e){if(Object(e)!==e)throw new TypeError("Object.seal can only be called on Objects.");return e}),Object.freeze||(Object.freeze=function(e){if(Object(e)!==e)throw new TypeError("Object.freeze can only be called on Objects.");return e});try{Object.freeze(function(){})}catch(M){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(e){if(Object(e)!==e)throw new TypeError("Object.preventExtensions can only be called on Objects.");return e}),Object.isSealed||(Object.isSealed=function(e){if(Object(e)!==e)throw new TypeError("Object.isSealed can only be called on Objects.");return!1}),Object.isFrozen||(Object.isFrozen=function(e){if(Object(e)!==e)throw new TypeError("Object.isFrozen can only be called on Objects.");return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)!==e)throw new TypeError("Object.isExtensible can only be called on Objects.");for(var t="";s(e,t);)t+="?";e[t]=!0;var n=s(e,t);return delete e[t],n})})},26:function(e,t){},35:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=n(9),r=n(2),s=r.info.nrtcVersion,a="https://statistic.live.126.net/statistic/realtime/sdkFunctioninfo",c=function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,u);var t=e.appkey,n=e.platform;this.apis={},this.isRtc=/WebRTC/.test(n),this.init(t,n),this.resetStatus()};t["default"]=c;var l=c.prototype;l.init=function(e,t){this.apis=Object.assign(this.apis,{ver:1,platform:t,sdk_ver:s||"v4.4.0",uid:null,appkey:e,time:null})},l.start=function(e){this.calling=!0,this.apis=Object.assign(this.apis,e)},l.resetStatus=function(){this.calling=!1,this.apis=Object.assign(this.apis,{p2p:{value:0},meeting:{value:0},bypass:{value:0},call_control_type:{value:0},self_mute:{value:-1},self_mic_mute:{value:-1},switch_p2p_type:{value:0},set_speaker:{value:-1},net_detect:{value:this.isRtc?-1:0},beautify:{value:-1},water_mark:{value:-1},audio_samples:{value:-1},video_samples:{value:-1},pre_view_mirror:{value:-1},code_mirror:{value:-1},custom_audio:{value:-1},custom_video:{value:-1},audio_mix:{value:-1},snap_shot:{value:-1},record:{value:0},audio_record:{value:0},display:{value:0},android_compatibility:{value:-1},hd_audio:{value:0},video_quality:{value:0},fps:{value:0},prefered_video_encoder:{value:-1},prefered_video_decoder:{value:-1},video_max_encode_bitrate:{value:this.isRtc?-1:0},audio_scene:{value:-1},video_adaptive_strategy:{value:this.isRtc?-1:0},ans:{value:this.isRtc?-1:0},agc:{value:-1},dtx:{value:-1},aec:{value:this.isRtc?-1:0},awc:{value:this.isRtc?-1:0}})},l.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=e.key,i=e.ext;e.constructor===String&&(n=e),i=i||t,this.apis[n]&&(this.apis[n].value=1,void 0!==i&&(this.apis[n].ext=i),/(p2p|meeting)/.test(n)&&(this.calling=!0))},l.send=function(){var e=this;this.calling&&(this.calling=!1,this.apis.time=Date.now(),(0,o.ajax)({type:"post",url:a,data:this.apis}).then(function(t){e.resetStatus()})["catch"](function(t){console.log("err",t),e.resetStatus()}))},e.exports=t["default"]},38:function(e,t){"use strict";t.__esModule=!0,t["default"]=function(e){if(!e.url||!e.data)return Promise.reject("参数不完整，无法发起请求");e.dataType=e.dataType||"json";var t=new XMLHttpRequest;return t.open(e.type||"GET",e.url,!0),t.responseType=""+e.dataType,t.setRequestHeader("Content-type","application/json;charset=UTF-8"),e.header&&Object.keys(e.header).map(function(n){t.setRequestHeader(n,e.header[n])}),new Promise(function(n,i){t.onload=function(){var e=t.response;n(e)},t.onerror=function(e){i(e)},t.send(JSON.stringify(e.data))})};e.exports=t["default"]},39:function(e,t){"use strict";t.__esModule=!0,t["default"]={merge:function(){var e=arguments;return e[0]=Object.assign.apply(Object.assign,arguments),e[0]},verifyOptions:function(){var e=arguments;if(e[0]&&e[0].constructor===Object)for(var t=1;t<arguments.length;t++){var n=e[t];n=n.split(" "),n.map(function(t){if(!e[0][t])throw Error("参数缺失 "+t)})}},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return function(){return e()+e()+e()+e()+e()+e()+e()+e()}}()},e.exports=t["default"]},41:function(e,t,n){"use strict";function i(e,t){for(var n in t)e[n]=t[n];return e}n(25),n(10),n(3).Promise,window.Object.assign||(console.log("Object.assign polyfill"),window.Object.assign=function(){for(var e=arguments,t=1;t<e.length;t++)e[0]=i(e[0],e[t]);return e[0]})},47:function(e,t){"use strict";t.__esModule=!0,t["default"]={html2node:function(e){var t=document.createElement("div");t.innerHTML=e;var n,i,o=[];if(t.children)for(n=0,i=t.children.length;n<i;n++)o.push(t.children[n]);else for(n=0,i=t.childNodes.length;n<i;n++){var r=t.childNodes[n];1===r.nodeType&&o.push(r)}return o.length>1?t:o[0]},n2node:function(e){return e?/HTML.+Element/gi.test(e)?e:e[0]&&/HTML.+Element/gi.test(e[0])?e[0]:null:null}},e.exports=t["default"]},48:function(e,t){"use strict";t.__esModule=!0;var n={gateWay:{login:1,loginAck:2,join:3,keep_alive:4,keep_alive_ack:5,keep_alive_node:6,broadcast:7,toUser:8,logout:9}},i={gateWay:{1:"login",2:"loginAck",3:"join",4:"keep_alive",5:"keep_alive_ack",6:"keep_alive_node",7:"broadcast",8:"toUser",9:"logout"}};t.serializeWb=n,t.unserializeWb=i},52:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(16),c=i(a),l=n(48),u=n(4),h=function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var i=r(this,e.call(this));return i.info=Object.assign({},n),i.init(),i.logger=n.logger||window.console,i.autoReconnect=n.autoReconnect||!0,i.isDestroy=!1,i.reConnectCount=0,i.wssUrl=null,i}return s(t,e),t}(u),p=h.prototype;p.init=function(){this.reset()},p.reset=function(){this.imInfo={}},p.connect=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.url,i=void 0===n?this.wssUrl:n,o=t.imInfo;return this.imInfo=o||this.imInfo,i?new Promise(function(t,n){e.url=i;var o=void 0;try{o=e.ws=new WebSocket("wss://"+i);var r=e;o.onopen=function(n){e.wssUrl=i,r.initSignal(),r.signalConnected=!0,console.log("signalConnected",i),r.emit("signalConnected"),t(r),e.heartbeat()},o.onclose=o.onerror=function(e){r.signalConnected=!1,n(e)}}catch(s){e.logger.error("信令连接建立失败",s),n(s)}}):Promise.reject("信令地址缺失")},p.initSignal=function(){var e=this,t=this.ws,n=t.send;t.send=function(e){n.call(this,JSON.stringify(e))},t.onmessage=function(t){var n=JSON.parse(t.data||null);if(n)return!e.isHeartBeating||"keep_alive_ack"!==n.type&&n.type!==l.serializeWb.gateWay.keep_alive_ack?void e.emit("message",n):void e.onHeartBeat(n)},t.onclose=function(t){e.signalConnected=!1,e.emit("signalTimeout",t)},t.onerror=function(t){e.signalConnected=!1,e.emit("signalError",t)}},p.send=function(e){var t=this;"keep_alive"!==e.type,this.ws&&this.signalConnected&&this.ws.readyState===this.ws.OPEN?(e.browser={},e.browser.name=window.platform.name,e.browser.version=window.platform.version,this.ws.send(e)):this.once("signalConnected",function(){t.send(e)})},p.heartbeat=function(){this.socketData=this.socketData||{uid:this.imInfo.uid,cid:this.imInfo.cid},this.heartBeatList=[],this.bindHearBeat(5)},p.onHeartBeat=function(e){this.heartBeatList.shift(),this.bindHearBeat(5)},p.heartBeatHandler=function(){var e=this.socketData,t=this.heartBeatList;if(t){var n=Date.now(),i=n;if(c["default"].CURRENT.SDK_TYPE===c["default"].SDK_TYPE.WHITEBOARD&&(i=+n.toString().slice(0,-3)),t.constructor===Array&&0===t.length){t.push(n);var o=this.getContentData({type:"keep_alive",uid:c["default"].CURRENT.SDK_TYPE===c["default"].SDK_TYPE.WHITEBOARD?+e.uid:e.uid+"",cid:c["default"].CURRENT.SDK_TYPE===c["default"].SDK_TYPE.WHITEBOARD?+e.cid:e.cid+""},i);return this.send(o),void this.bindHearBeat(5)}var r=Date.now()-t[0];if(r>3e4)this.logger.error("socket error: heartbeat timeout"),this.emit("signalTimeout");else if(r>2e3&&r<3e4){this.logger.warn("socket error: no response, keep heartbeat"),t.push(n);var s=this.getContentData({type:"keep_alive",uid:e.uid,cid:e.cid},i);this.send(s),this.bindHearBeat(2)}}},p.getContentData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return c["default"].CURRENT.SDK_TYPE===c["default"].SDK_TYPE.WHITEBOARD?(e.version=31,e.type=l.serializeWb.gateWay[e.type],e.content={params:{timestamp:+t}}):e.params={content:{timestamp:t+""}},e},p.bindHearBeat=function(e){this.isHeartBeating&&clearTimeout(this.isHeartBeating),this.isHeartBeating=setTimeout(this.heartBeatHandler.bind(this),1e3*e)},p.stopHeartBeat=function(){this.isHeartBeating&&(this.isHeartBeating&&clearTimeout(this.isHeartBeating),this.heartBeatTimer&&clearInterval(this.heartBeatTimer),this.isHeartBeating=null,this.heartBeatTimer=null,this.heartBeatList=null,this.heartBeatCount=0)},p.logout=function(){var e=this.socketData,t=Date.now().toString(),n=this.getContentData({type:"logout",uid:e.uid,cid:e.cid},t);this.send(n)},p.destroy=function(){this.logger.log("signal close -> signal.js"),this.stopHeartBeat(),this.isDestroy=!0,this.ws&&(this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.readyState===WebSocket.OPEN&&this.ws.close(),this.ws=null)},t["default"]=h,e.exports=t["default"]},62:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(9),a=n(4),c=function(e){function t(n){i(this,t);var r=o(this,e.call(this));return n.container=s.element.n2node(n.container),n.remoteContainer=s.element.n2node(n.remoteContainer),s.tool.merge(r,n),r.init(),r}return r(t,e),t}(a),l=c.prototype;l.init=function(){var e=this;this.resetStatus(),window.addEventListener("beforeunload",this.beforeunload.bind(this));var t=this.nim&&this.nim.logger||window.console;this.logger={log:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.debug&&t.log.apply(t,arguments)},error:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.debug&&t.error.apply(t,arguments)},warn:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.debug&&t.warn.apply(t,arguments)}}},l.resetStatus=function(){this.signalInited=!1,this.channelId=null,this.type=null,this.target={account:null,uid:null},this.sessionConfig={},this.sessionMode=null,this.imInfo={},this.calling=!1,this.isCaller=!1,this.callee=null,this.callAccepted=!1,this.callerInfo=null,this.beCalledInfo=null,this.nim&&(this.nim.protocol&&this.nim.protocol.setCurrentNetcall&&this.nim.protocol.setCurrentNetcall(),this.nim.protocol&&this.nim.protocol.setCurrentWhiteBoard&&this.nim.protocol.setCurrentWhiteBoard()),this.needQueryAccountMap={},this.accountUidMap={},this.uidAccountMap={},this.isOnHangup=!1},l.beforeunload=function(){this.signalInited&&(this.callerInfo||this.beCalledInfo?this.hangup():this.leaveChannel())},l.baseGetAccount=function(){return this.nim&&this.nim.account},l.baseGetUid=function(){return this.accountUidMap?this.accountUidMap[this.nim.account]||"-1":"-1"},l.parseAccountUidMap=function(e){var t=this;Object.keys(e).forEach(function(n){t.addAccountUidMap({account:n,uid:e[n]})})},l.addAccountUidMap=function(e){var t=e.account,n=e.uid;this.uidAccountMap||(this.uidAccountMap={}),this.uidAccountMap[n]=t,this.accountUidMap||(this.accountUidMap={}),this.accountUidMap[t]=n},l.getAccountWithUid=function(e){if(this.uidAccountMap)return this.uidAccountMap[e]},l.getUidWithAccount=function(e){if(this.accountUidMap)return this.accountUidMap[e]},l.baseIsCurrentChannelId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.channelId&&this.channelId===e.channelId},l.baseNotCurrentChannelId=function(e){return!this.baseIsCurrentChannelId(e)},l.baseResponse=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.fn||"calleeAck",i=t.beCalledInfo||this.beCalledInfo,o=i.accepted=t.accepted!==!1;return o?(this.sessionMode="p2p",this.type=i.type,this.channelId=i.channelId,this.target.account=i.account,this.calling=!0,this.imInfo=i,this.imInfo.sessionMode=this.sessionMode,this.imInfo.role=0,this.setSessionConfig({signalStartTime:Date.now()})):(this.logger.log("reject call",i),this.packNetcallRecord({type:i.type,channelId:i.channelId,isCaller:!1,target:i.account,recordType:"rejectNetcall"})),this.nim[n](i).then(function(){o&&(t.sessionConfig&&e.setSessionConfig(t.sessionConfig),e.beCalledInfo=i,e.initSession({beCalledInfo:i}))},function(t){throw e.logger.log(t),t})},l.baseControl=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.channelId=t.channelId||this.channelId,t.command&&t.channelId){this.controller.uploadDataApi("update",{key:"call_control_type"});var n=t.fn||"netcallControl";return t.type=t.command,this.nim[n](t)["catch"](function(t){e.logger.log(t)})}},l.baseHangup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controller.uploadDataApi("send");var t=e.channelId,n=void 0===t?this.channelId:t,i=e.recordType;if(n){var o=e.fn||"hangup";this.nim[o]({channelId:n})}n===this.channelId&&(this.isCaller&&!this.callAccepted&&(this.logger.log(i,{channelId:n}),this.packNetcallRecord({recordType:i})),this.resetWhenHangup())},l.baseStartSession=function(){this.imInfo.cid=this.imInfo.cid||this.imInfo.channelId;var e=this.sessionMode=this.sessionMode||"p2p";this.imInfo.sessionMode=e,this.imInfo.sessionConfig=this.sessionConfig,this.imInfo.serverMap&&this.imInfo.serverMap.constructor===String&&(this.imInfo.serverMap=JSON.parse(this.imInfo.serverMap))},l.packNetcallRecord=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.recordType,n=e.type||this.type,i=e.channelId||this.channelId,o=e.duration||0,r=e.isCaller||this.isCaller,a=e.target||this.target.account,c=this.baseGetAccount(),l=r?c:a,u=r?a:c,h=+new Date;this.nim.protocol.onMsg({content:{msg:{attach:JSON.stringify({data:{calltype:n,channel:i,duration:o,ids:[c,a],time:h},id:t}),from:l,fromClientType:r?16:0,fromDeviceId:"",fromNick:"",idClient:s.tool.guid(),idServer:s.tool.guid(),scene:0,time:h,to:u,type:5}}})},l.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s.tool.merge(this.sessionConfig,e)},l.initSignal=function(){return Promise.resolve()},l.initSession=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionMode="p2p";var n=this.isCaller?this.callerInfo:t.beCalledInfo;this.parseAccountUidMap(n.accountUidMap),!n.account&&n.uid&&(n.account=this.getAccountWithUid(n.uid)),this.callAccepted=!0,this.signalInited=!0,this.setSessionConfig({signalEndTime:Date.now()}),this.controller.uploadDataApi("start",{uid:n.uid}),this.target.uid=this.getUidWithAccount(this.target.account);var i={type:n.type,account:this.target&&this.target.account||n.account,channelId:n.channelId};n.netcallType&&(i.netcallType=n.netcallType),this.imInfo.target=this.target,setTimeout(function(){e.emit("callAccepted",i)},1)},l.onBeCalled=function(e){this.signalInited=!0,this.channelId=e.channelId,this.beCalledInfo=e,this.logger.log("beCalling",e),this.emit("beCalling",e)},l.onUserJoin=function(e){if(this.logger.log("client on userJoined",e),e.type=e.type||this.type,e.account=this.getAccountWithUid(e.uid),e.mode=this.sessionMode,e.account!==this.baseGetAccount()){if(e.account)return this.logger.log("userjoin ----> from signal",e),void this.emit("joinChannel",e);this.needQueryAccountMap[e.uid]=e;var t=this.nim.queryAccountUidMap||this.nim.wbQueryAccountUidMap;t.call(this.nim,this.channelName,[e.uid])}},l.onUserLeft=function(e){var t=this;this.imInfo.channelId&&(this.logger.log("leave channel from signal"),"p2p"===this.imInfo.sessionMode?(this.controller.uploadDataApi("send"),setTimeout(function(){t.logger.log("超时处理 onUserLeft"),t.resetWhenHangup()},1e3),this.emit("hangup",{channelId:e.channelId||e.cid,account:this.target.account,type:e.type||0})):this.emit("leaveChannel",{channelId:e.channelId||e.cid,account:this.getAccountWithUid(e.uid),type:e.type||0}))},l.onNotifyJoin=function(e){if(this.logger){this.logger.log("join channel from IM");var t=e.accountUidMap,n=this.needQueryAccountMap;this.parseAccountUidMap(t);for(var i in t){var o=i,r=t[i];if(r in n){var s=n[r];s.account=o,delete n[r],this.logger.log("userjoin ----> from IM",e),this.emit("joinChannel",s)}}}},l.onCalleeAck=function(e){if(this.logger.log("收到被叫的通知",e),!this.baseNotCurrentChannelId(e)){var t=e.account,n=this.beCalledInfo||this.callerInfo;this.target.account=t,this.setSessionConfig({signalEndTime:Date.now()}),e.accepted?(this.callAccepted=!0,this.initSession()):(this.logger.log("call Rejected",e),this.packNetcallRecord({type:e.type,channelId:e.channelId,isCaller:!0,target:e.account,recordType:"netcallRejected"}),this.resetWhenHangup(),this.emit("callRejected",{type:n.type,account:t}))}},l.onHangup=function(e){var t=this;this.channelId&&"p2p"===this.sessionMode&&(this.logger.log("on hangup from IM"),this.controller.uploadDataApi("send"),setTimeout(function(){t.logger.log("超时处理 onHangup"),t.resetWhenHangup()},1e3),this.emit("hangup",{channelId:e.channelId,account:e.account,type:0}))},l.onControl=function(e){this.emit("control",e)},l.onCalleeAckSync=function(e){this.emit("callerAckSync",e),this.baseIsCurrentChannelId(e)&&this.resetWhenHangup()},l.baseCreateChannel=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.tool.verifyOptions(n,"channelName"),n.custom=n.custom||"",this.setSessionConfig({signalStartTime:Date.now()}),this.nim[e](n).then(function(e){return Promise.resolve(e)})["catch"](function(e){return t.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(e)})},l.baseJoinChannel=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.nim[e](n).then(function(e){return t.setSessionConfig({signalEndTime:Date.now()}),t.signalInited=!0,t.sessionMode=e.sessionMode="meeting",t.parseAccountUidMap(e.accountUidMap),e.uid=t.getUidWithAccount(t.nim.account),Promise.resolve(e)})["catch"](function(e){return t.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(e)})},l.format=function(e){return e.rtcServerMap&&(e.rtcServerMap=JSON.parse(e.rtcServerMap),e.rtcServerMap=e.rtcServerMap.webrtcarray||[e.rtcServerMap.webrtc]||e.rtcServerMap),e.wbServerMap&&(e.wbServerMap=JSON.parse(e.wbServerMap),e.wbServerMap=e.wbServerMap.webrtcarray||[e.wbServerMap.webrtc]||e.wbServerMap),e},l.resetWhenHangup=function(){},e.exports=c},63:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(52),c=i(a),l=n(16),u=i(l),h=n(35),p=i(h),d=n(4),f=function(e){return new p["default"](e)},b=function(e){function t(n){o(this,t);var i=r(this,e.call(this,n));return i.info={},i._init(n),i._reset(),i}return s(t,e),t.prototype._init=function(e){this.info=Object.assign(this.info,e),this.logger=e.logger||window.console,u["default"].STATS_RTC[u["default"].CURRENT.SDK_TYPE]&&(this.dataApi=f({appkey:this.info.appKey,platform:u["default"].SDK_NAME[u["default"].CURRENT.SDK_TYPE]}))},t.prototype._reset=function(){this.signal&&(this.signal.destroy(),this.signal=null),this.sessionConfig={},this.imInfo={},this.target={},this.userJoinTimeoutId=0,this.remoteNodeStatus={}},t.prototype.resetStatus=function(){this._reset()},t.prototype._startSession=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.imInfo||e;t.uid=+t.uid,t.cid=+t.cid,this.setSessionConfig(t.sessionConfig);var n=t.serverMap||{};t.urlArray=t.serverAddrs||n.webrtcarray||[n.webrtc];var i=void 0;return i=this.signal?Promise.resolve(this.signal):this._initSignal()},t.prototype._initSignal=function(){var e=this;if(this.signal)return Promise.resolve();var t=new c["default"]({logger:this.logger}),n=this.imInfo.urlArray;if(n){var i=n.shift();return i?t.connect({url:i,imInfo:this.imInfo}).then(function(t){return e.signal=t,e._initSignalEvent(),Promise.resolve(t.url)})["catch"](function(t){return e._initSignal()}):Promise.reject("无可用的网关服务器地址, 如果当前应用是WebRTC音视频, 请确保对方打开了WebRTC兼容开关")}},t.prototype._initSignalEvent=function(){var e=this,t=this.signal;t.on("signalTimeout",this.onSignalTimeout.bind(this)),t.on("message",this.onSignalMessage.bind(this)),t.on("signalClosed",function(){e.emit("signalClosed"),e.resetStatus()}),this.signal.on("signalError",function(t){e.emit("signalClosed"),e._stopSignal()})},t.prototype._stopSignal=function(){this.signal&&(this.signal.destroy(),this.signal=null)},t.prototype._stopSession=function(){this._stopSignal(),this._reset()},t.prototype._logout=function(){this.signal&&this.signal.logout()},t.prototype.setAppKey=function(e){e&&(this.info.appKey=e)},t.prototype.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionConfig=Object.assign(this.sessionConfig,e)},t.prototype.onSignalMessage=function(e){},t.prototype.onSignalTimeout=function(e){},t.prototype.uploadDataApi=function(e,t){u["default"].STATS_FUN[u["default"].CURRENT.SDK_TYPE]&&this.info.appKey&&("start"===e&&(t.appkey=this.info.appKey),this.dataApi[e]&&this.dataApi[e](t))},t}(d);t["default"]=b,e.exports=t["default"]},78:function(e,t){"use strict";function n(e){i(e.enable)&&(this.enable=e.enable?1:0),i(e.needBadge)&&(this.needBadge=e.needBadge?1:0),i(e.needPushNick)&&(this.needPushNick=e.needPushNick?1:0),i(e.pushContent)&&(this.pushContent=""+e.pushContent),i(e.custom)&&(this.custom=""+e.custom),i(e.pushPayload)&&(this.pushPayload=""+e.pushPayload),i(e.sound)&&(this.sound=""+e.sound),i(e.webrtcEnable)&&(this.webrtcEnable=e.webrtcEnable?1:0)}t.__esModule=!0,t["default"]=function(e){var t=e.util;return i=t.notundef,n};var i=void 0;e.exports=t["default"]},116:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(63),c=i(a),l=n(48),u=n(13),h=n(9),p=3,d=null,f=null,b=function(e){function t(n){o(this,t);var i=r(this,e.call(this,n));return i.logger=n.logger||{},i.resetStatus(),i}return s(t,e),t}(c["default"]);t["default"]=b,b.use=function(e){e&&e.constructor===Function&&(d=e)};var g=b.prototype;g.resetStatus=function(){this.wbAdapter&&(this.wbAdapter.destroy(),this.wbAdapter=null),this.nodeTimer&&(clearInterval(this.nodeTimer),this.nodeTimer=null),this.reConnectCount=0,this.recv_bytes=0,this.send_bytes=0},g.startSession=function(e){var t=this;return this.imInfo=e||this.imInfo,this.connect().then(function(){t.initWbAdapter(),t.enableDraw(0===t.imInfo.role||"p2p"===t.imInfo.sessionMode)})},g.connect=function(){var e=this;return this._startSession().then(function(t){return f=t,e.reConnectCount=0,new Promise(function(t,n){e.wbLogin(),e.once("LoginSuccess",function(n){e.logger.log("once LoginSuccess-->",n),t(f)}),e.once("LoginFailed",function(t){e.logger.log("once LoginFailed-->",t),n(t)})})})},g.destroy=function(){this.stopSession()},g.stopSession=function(){return this.wbLogout(),this._stopSession(),this.resetStatus(),Promise.resolve()},g.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h.tool.merge(this.sessionConfig,e)},g.initWbAdapter=function(){if(!this.wbAdapter&&this.info.container){if(!d)return void console.warn("初始化绘图环境失败，如果依赖外部绘图插件，请先使用WhiteBoard.use()进行安装");this.wbAdapter=new d(this.info.container,{nim:this.info.client.nim,UID:this.imInfo.uid,backgroundUrl:this.sessionConfig.backgroundUrl||"",color:this.sessionConfig.color,width:+this.sessionConfig.width,height:+this.sessionConfig.height,mode:this.sessionConfig.mode||"free",limit:60,debug:this.info.debug}),this.wbAdapter.on("action",this.onWbAdapterData.bind(this))}},g.setContainer=function(e){e=h.element.n2node(e),this.info.container=e,this.wbAdapter?this.wbAdapter.setContainer(e):this.initWbAdapter()},g.enableDraw=function(e){this.wbAdapter&&this.wbAdapter.enableDraw(e)},g.onWbAdapterData=function(e,t){var n=e.key,i=void 0===n?0:n,o=e.data;if(i=+i,o&&(0!==i||0===this.imInfo.role)){this.sendStats(o),i&&o.uid&&(o.account=this.info.client.getAccountWithUid(o.uid),o="9:"+o.account+",1;"+o.data);var r={data:o};"p2p"===this.imInfo.sessionMode&&(r.dst_client_id=this.target&&this.target.uid||0),i-0&&(r.dst_client_id=+i);var s=r.dst_client_id?l.serializeWb.gateWay.toUser:l.serializeWb.gateWay.broadcast;this.sendMsg(s,r)}},g.wbLogin=function(){var e={token:this.imInfo.cid,client_type:2,client_net:2,client_os:6,client_support_record:~~this.sessionConfig.record};this.sendMsg(l.serializeWb.gateWay.login,e)},g.wbLogout=function(){var e=Date.now(),t={timestamp:e,recv_bytes:this.recv_bytes,send_bytes:this.send_bytes};this.sendMsg(l.serializeWb.gateWay.logout,t)},g.sendMsg=function(e,t){var n={type:e,uid:+this.imInfo.uid,cid:+this.imInfo.cid,version:31,content:{params:t}};this.signal&&this.signal.send(n)},g.onSignalMessage=function(e){if(e&&e.cid&&e.uid&&(e.cid=+e.cid,e.uid=+e.uid),e.cid!==this.imInfo.cid)return console.error("websocket message not belong to this session");var t=l.unserializeWb.gateWay[e.type];this["on"+t]&&this["on"+t](e)},g.onloginAck=function(e){var t=this,n=e.content.params.auth_result-0;return 200!==n?(this.logger.error("服务器验证不通过, 断开连接"),void this.emit("LoginFailed",{code:n,error:"服务器验证不通过, 断开连接"})):(this.logger.log("白板服务器登录成功",e),this.emit("LoginSuccess"),void("p2p"===this.imInfo.sessionMode&&(this.logger.log("45s之内等待对方加入"),this.userJoinTimeoutId=setTimeout(function(){t.userJoinTimeoutId&&0===Object.keys(t.remoteNodeStatus).length&&t.emit("error",{error:"点对点对方登录超时, 断开连接"})},45e3))))},g.onjoin=function(e){this.logger.log(e);var t=e.content&&e.content.params&&e.content.params.client_id;this.startNodeMonitor(t),"p2p"===this.imInfo.sessionMode&&(this.target={uid:t},this.initWbAdapter(),this.userJoinTimeoutId&&clearTimeout(this.userJoinTimeoutId),this.userJoinTimeoutId=0),this.emit("userJoined",{uid:t,cid:e.cid})},g.onkeep_alive_node=function(e){var t=e.uid,n=this.remoteNodeStatus;n[t]=n[t]||{now:Date.now(),total:45},n[t].now=Date.now(),n[t].total=45},g.onlogout=function(e){this.logger.log("onlogout",e),this.wbAdapter&&this.wbAdapter.removeUser(e.uid),this.emit("leaveChannel",{uid:e.uid,channelId:e.cid}),delete this.remoteNodeStatus[e.uid]},g.ontoUser=function(e){this.onData(e)},g.onbroadcast=function(e){this.onData(e)},g.onData=function(e){var t=e.content&&e.content.params&&e.content.params.data,n=e.uid;this.receiveStats(t);var i=void 0;try{i=JSON.parse(t||null)}catch(o){i=t}return this.onkeep_alive_node({uid:n}),this.info.isCustom?void this.emit("data",{uid:n,data:i}):i.constructor===Object?void(i.isCustom&&this.emit("customData",{UID:e.uid,data:i.data})):(this.wbAdapter&&this.wbAdapter.act({UID:e.uid,data:i}),this.remoteNodeStatus[e.uid].now=Date.now(),void(this.remoteNodeStatus[e.uid].total=45))},g.startNodeMonitor=function(e){var t=this,n=this.remoteNodeStatus;n[e]=n[e]||{now:Date.now(),total:45},n[e].now=Date.now(),this.nodeTimer||(this.nodeTimer=setInterval(function(){var i=Date.now();Object.keys(n).map(function(o){return i-n[o].now>5e4||n[o].total<=0?(t.logger.warn("节点45s超时离开:",o),t.emit("leaveChannel",{uid:o,type:u.constantBB.HANGUP_TYPE_TIMEOUT,channelId:t.imInfo.cid}),delete t.remoteNodeStatus[e],void delete n[o]):i-n[o].now>5e3?void(n[o].total-=5):void 0})},5e3))},g.onSignalTimeout=function(){var e=this;return this.emit("disconnected"),this.reConnectCount>=p?void this.emit("signalClosed"):(this.reConnectCount++,this.emit("willReconnect",this.reConnectCount),this.logger.log("3s后尝试第"+this.reConnectCount+"次重连服务器"),this._stopSignal(),void setTimeout(function(){e.imInfo&&e.imInfo.serverAddrs&&(e.logger.log("开始第"+e.reConnectCount+"次重连服务器"),f&&e.imInfo.serverAddrs.unshift(f),e.connect().then(function(){e.emit("connected",e.reConnectCount)})["catch"](function(t){e.logger.error("reconnect error",t),e.onSignalTimeout()}))},3e3))},g.setDrawMode=function(e){this.wbAdapter&&this.wbAdapter.setDrawMode(e)},g.setColor=function(e){this.wbAdapter&&this.wbAdapter.setColor(e)},g.setStyle=function(e){this.wbAdapter&&this.wbAdapter.setStyle(e)},g.undo=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.undo()},g.redo=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.redo()},g.clear=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.clear()},g.image=function(e,t){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.image(e,t)},g.clearImage=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.clearImage()},g.resize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.resize(e.width)},g.sendCustomData=function(e){0===this.imInfo.role&&this.onWbAdapterData({key:0,data:e})},g.sendStats=function(e){this.send_bytes+=e.length},g.receiveStats=function(e){this.recv_bytes+=e.length},g.syncBegin=function(){this.wbAdapter&&this.wbAdapter.syncBegin()},g.syncRequest=function(e){this.wbAdapter&&this.wbAdapter.syncRequest(e)},g.syncResponse=function(){this.wbAdapter&&this.wbAdapter.syncResponse()},e.exports=t["default"]},217:function(e,t){"use strict";t.__esModule=!0,t["default"]={getAccount:function(){return this.baseGetAccount()},getUid:function(){return this.baseGetUid()},isCurrentChannelId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.baseIsCurrentChannelId(e)},notCurrentChannelId:function(e){
return!this.isCurrentChannelId(e)},startSession:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sessionStarted?Promise.resolve():(this.sessionStarted=!0,e.wssArr&&(this.imInfo.serverAddrs=e.wssArr.constructor===Array?e.wssArr:[e.wssArr]),this.baseStartSession(),this.controller.startSession(this.imInfo))},stopSession:function(){return this.resetWhenHangup(),Promise.resolve()},leaveChannel:function(){this.stopSession()},changeRoleToPlayer:function(){return 0===this.imInfo.role?Promise.resolve({role:"player"}):(this.controller.enableDraw(!0),this.imInfo.role=0,Promise.resolve({role:"player"}))},changeRoleToAudience:function(){var e=this;return 1===this.imInfo.role?Promise.resolve({role:"audience"}):(this.controller.enableDraw(!1),new Promise(function(t,n){setTimeout(function(){e.imInfo.role=1,t({role:"audience"})},1e3)}))},undo:function(){this.controller.undo()},redo:function(){this.controller.redo()},setContainer:function(e){this.controller.setContainer(e)},image:function(e,t){var n=this.getUidWithAccount(t||this.imInfo.account);this.controller.image(e,n)},clearImage:function(){this.controller.clearImage()},clear:function(){this.controller.clear()},resize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controller.resize(e)},sendCustomData:function(e){this.controller.sendCustomData(e)},send:function(e){this.controller.sendCustomData(e)},setDrawMode:function(e){this.controller.setDrawMode(e)},setColor:function(e){this.controller.setColor(e)},setStyle:function(e){this.controller.setStyle(e)},syncBegin:function(){this.controller.syncBegin()},syncRequest:function(e){if(!e)throw Error("同步请求目标账号缺失");var t=this.getUidWithAccount(e);if(!t)throw Error("syncRequest 同步请求目标账号不正确");this.controller.syncRequest(t)}},e.exports=t["default"]},239:function(e,t,n){"use strict";var i=n(78),o={};o.install=function(e){var t=e.fn,n=e.util,o=i({util:n});t.initWhiteBoard=function(e){return n.verifyOptions(e,"type accounts","wb::initWhiteBoard"),e.pushContent="",e.custom="",e.pushConfig||(e.pushConfig={}),e.pushConfig.webrtcEnable=e.webrtcEnable,e.pushConfig=new o(e.pushConfig),this.cbAndSendCmd("initWhiteBoard",e)},t.wbKeepCalling=function(e){return n.verifyOptions(e,"type accounts channelId","wb::wbKeepCalling"),this.cbAndSendCmd("wbKeepCalling",e)},t.wbCalleeAck=function(e){return n.verifyOptions(e,"account channelId type accepted","wb::wbCalleeAck"),this.cbAndSendCmd("wbCalleeAck",e)},t.wbHangup=function(e){return n.verifyOptions(e,"channelId","wb::wbHangup"),this.cbAndSendCmd("wbHangup",e)},t.wbControl=function(e){return n.verifyOptions(e,"channelId type","wb::wbControl"),this.cbAndSendCmd("wbControl",e)},t.wbCreateChannel=function(e){return this.cbAndSendCmd("wbCreateChannel",e)},t.wbJoinChannel=function(e){return n.verifyOptions(e,"channelName","wb::wbJoinChannel"),n.verifyBooleanWithDefault(e,"liveEnable",!1,"","wb::wbJoinChannel"),n.verifyBooleanWithDefault(e,"webrtcEnable",!1,"","wb::wbJoinChannel"),this.cbAndSendCmd("wbJoinChannel",{channelName:e.channelName,liveOption:{liveEnable:e.liveEnable?1:0,webrtcEnable:e.webrtcEnable?1:0}})},t.wbQueryAccountUidMap=function(e,t){return this.cbAndSendCmd("wbQueryAccountUidMap",{channelName:e,uids:t})}},e.exports=o},240:function(e,t){"use strict";var n={};n.install=function(e){var t=e.Protocol.fn;t.processDatatun=function(e){switch(e.cmd){case"initWhiteBoard":this.onWbInit(e);break;case"wbBeCalled":this.onWbBeCalled(e);break;case"wbKeepCalling":this.onWbKeepCalling(e);break;case"wbCalleeAck":break;case"wbNotifyCalleeAck":this.onWbNotifyCalleeAck(e);break;case"wbHangup":break;case"wbNotifyHangup":this.onWbNotifyHangup(e);break;case"wbNotifyControl":this.onWbControl(e);break;case"wbNotifyCalleeAckSync":this.onWbNotifyCalleeAckSync(e);break;case"wbNotifyRecord":break;case"wbCreateChannel":break;case"wbJoinChannel":this.wbJoinChannel(e);break;case"wbNotifyJoin":this.onWbNotifyJoin(e)}},t.onWbInit=function(e){if(!e.error){var t=e.obj.type;e.obj=e.content,e.obj.type=t,e.obj.accounts=e.obj.keepCallingAccounts,this.setCurrentWhiteBoard(e.obj.channelId),this.wbKeepCalling(e)}},t.setCurrentWhiteBoard=function(e){this.currentWhiteBoardChannelId=e},t.onWbKeepCalling=function(e){e.error||e.content.accounts.length&&this.wbKeepCalling(e)},t.wbKeepCalling=function(e){var t=this,n=e.obj,i=n.type,o=n.accounts,r=n.channelId;o&&o.length&&setTimeout(function(){t.currentWhiteBoardChannelId&&t.currentWhiteBoardChannelId===r&&t.api.wbKeepCalling({type:i,accounts:o,channelId:r})["catch"](function(){})},3e3)},t.onWbBeCalled=function(e){e.error||this.emitAPI({type:"wbBeCalled",obj:e.content})},t.onWbNotifyCalleeAck=function(e){e.error||this.emitAPI({type:"wbNotifyCalleeAck",obj:e.content})},t.onWbNotifyHangup=function(e){e.error||this.emitAPI({type:"wbNotifyHangup",obj:e.content})},t.onWbControl=function(e){e.error||this.emitAPI({type:"wbControl",obj:e.content})},t.onWbNotifyCalleeAckSync=function(e){e.error||this.emitAPI({type:"wbNotifyCalleeAckSync",obj:e.content})},t.onWbNotifyJoin=function(e){e.error||this.emitAPI({type:"wbNotifyJoin",obj:e.content})},t.wbJoinChannel=function(e){e.obj=e.content}},e.exports=n},241:function(e,t){"use strict";var n=11,i={wb:{id:n,initWhiteBoard:1,wbKeepCalling:2,wbCalleeAck:4,wbNotifyCalleeAck:5,wbHangup:8,wbNotifyHangup:9,wbControl:10,wbNotifyControl:11,wbNotifyRecord:12,wbCreateChannel:13,wbJoinChannel:14,wbNotifyJoin:15,wbQueryAccountUidMap:16}},o={initWhiteBoard:{sid:n,cid:i.wb.initWhiteBoard,params:[{type:"StrArray",name:"type"},{type:"StrArray",name:"accounts"},{type:"String",name:"pushContent"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"}]},wbKeepCalling:{sid:n,cid:i.wb.wbKeepCalling,params:[{type:"StrArray",name:"accounts"},{type:"long",name:"channelId"}]},wbCalleeAck:{sid:n,cid:i.wb.wbCalleeAck,params:[{type:"long",name:"channelId"},{type:"bool",name:"accepted"}]},wbHangup:{sid:n,cid:i.wb.wbHangup,params:[{type:"long",name:"channelId"}]},wbControl:{sid:n,cid:i.wb.wbControl,params:[{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"string",name:"info"}]},wbCreateChannel:{sid:n,cid:i.wb.wbCreateChannel,params:[{type:"String",name:"channelName"},{type:"String",name:"custom"},{type:"String",name:"webrtcEnable"}]},wbJoinChannel:{sid:n,cid:i.wb.wbJoinChannel,params:[{type:"String",name:"channelName"},{type:"Property",name:"liveOption"}]},wbQueryAccountUidMap:{sid:n,cid:i.wb.wbQueryAccountUidMap,params:[{type:"String",name:"channelName"},{type:"LongArray",name:"uids"}]}},r="datatun",s={"11_1":{service:r,cmd:"initWhiteBoard",response:[{type:"Number",name:"timetag"},{type:"Number",name:"uid"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrArray",name:"keepCallingAccounts"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"clientConfig"}]},"11_2":{service:r,cmd:"wbKeepCalling",response:[{type:"StrArr",name:"accounts"}]},"11_3":{service:r,cmd:"wbBeCalled",response:[{type:"Number",name:"timetag"},{type:"String",name:"account"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"custom"},{type:"Number",name:"uid"},{type:"String",name:"clientConfig"},{type:"Property",name:"pushConfig"}]},"11_4":{service:r,cmd:"wbCalleeAck",response:[]},"11_5":{service:r,cmd:"wbNotifyCalleeAck",response:[{type:"long",name:"channelId"},{type:"String",name:"account"},{type:"bool",name:"accepted"}]},"11_6":{service:r,cmd:"wbNotifyCalleeAckSync",response:[{type:"String",name:"timetag"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"},{type:"byte",name:"fromClientType"}]},"11_7":{service:r,cmd:"xxxx",response:[]},"11_8":{service:r,cmd:"wbHangup",response:[]},"11_9":{service:r,cmd:"wbNotifyHangup",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"String",name:"account"}]},"11_10":{service:r,cmd:"wbControl",response:[]},"11_11":{service:r,cmd:"wbNotifyControl",response:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"string",name:"info"},{type:"long",name:"channelId"}]},"11_12":{service:r,cmd:"wbNotifyRecord",response:[{type:"Property",name:"msg"}]},"11_13":{service:r,cmd:"wbCreateChannel",response:[{type:"long",name:"timetag"}]},"11_14":{service:r,cmd:"wbJoinChannel",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"},{type:"Property",name:"turnInfoTag"},{type:"String",name:"custom"}]},"11_15":{service:r,cmd:"wbNotifyJoin",response:[{type:"Long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"}]},"11_16":{service:r,cmd:"wbQueryAccountUidMap",response:[]}};e.exports={idMap:i,cmdConfig:o,packetConfig:s}},242:function(e,t){"use strict";e.exports={pushConfig:{enable:1,needBadge:2,needPushNick:3,pushContent:4,custom:5,pushPayload:6,sound:7,webrtcEnable:10},liveOption:{liveEnable:1,webrtcEnable:2},turnInfoTag:{channelId:0,tunnelServer:1,proxyServer:2,stunServer:3,type:4,dispatchServer:5}}},243:function(e,t){"use strict";e.exports={pushConfig:{1:"enable",2:"needBadge",3:"needPushNick",4:"pushContent",5:"custom",6:"pushPayload",7:"sound",10:"webrtcEnable"},liveOption:{1:"liveEnable",2:"webrtcEnable"},turnInfoTag:{0:"channelId",1:"tunnelServer",2:"proxyServer",3:"stunServer",4:"type",5:"dispatchServer"}}},254:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(16),c=i(a),l=n(62),u=i(l),h=n(116),p=i(h),d=n(9),f=n(13),b=n(217),g=i(b);c["default"].CURRENT.SDK_TYPE=c["default"].SDK_TYPE.WHITEBOARD;var m=function(e){function t(n){o(this,t);var i=r(this,e.call(this,n));return i.initWB(),i}return s(t,e),t.prototype.initWB=function(){if(!this.nim)throw new Error({error:"请传入nim实例"});this.initProtocol(),this.initController()},t.prototype.initProtocol=function(){var e=this.nim;e.on("wbBeCalled",this.onBeCalled.bind(this)),e.on("wbNotifyCalleeAck",this.onCalleeAck.bind(this)),e.on("wbNotifyHangup",this.onHangup.bind(this)),e.on("wbControl",this.onControl.bind(this)),e.on("wbNotifyCalleeAckSync",this.onCalleeAckSync.bind(this)),e.on("wbNotifyJoin",this.onNotifyJoin.bind(this))},t.prototype.initController=function(){var e=this;window.myWbContrl=this.controller=new p["default"]({appKey:this.nim&&this.nim.options.appKey,debug:this.debug,container:this.container,logger:this.logger,client:this,isCustom:this.isCustom}),this.controller.on("userJoined",this.onUserJoin.bind(this)),this.controller.on("signalClosed",function(t){e.emit("signalClosed",t)}),this.controller.on("willReconnect",function(t){e.emit("willReconnect",t)}),this.controller.on("disconnected",function(t){e.emit("disconnected",t)}),this.controller.on("connected",function(t){e.emit("connected",t)}),this.controller.on("leaveChannel",this.onUserLeft.bind(this)),this.controller.on("error",function(t){e.emit("error",t)}),this.controller.on("customData",function(t){e.emit("customData",t)}),this.controller.on("data",function(t){e.emit("data",{account:e.getAccountWithUid(t.uid),data:t.data})}),window.addEventListener("beforeunload",this.beforeunload.bind(this))},t.prototype.destroy=function(){var e=this;this.controller.destroy(),this.controller=null,this.nim=null,Object.keys(this).map(function(t){e[t]=null,delete e[t]})},t.prototype.serializeType=function(e,t){return t&&t!==f.constantBB.CALL_TYPE_NONE?t!==f.constantBB.CALL_TYPE_AUDIO?[e]:[t,e]:[e]},t.prototype.unserializeType=function(e){var t={},n=-1;return e.map(function(e,i){e===f.constantBB.CALL_TYPE_AUDIO&&(t.netcallType=f.constantBB.CALL_TYPE_AUDIO,n=i)}),n!==-1&&e.splice(t.i,1),t.type=e[0],t},t.prototype.call=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.account,n=e.type,i=e.netcallType,o=e.pushConfig,r=e.sessionConfig;return this.calling=!0,this.isCaller=!0,this.callee=t,this.target.account=t,r&&(r.signalStartTime=Date.now(),this.controller.setSessionConfig(r)),this.initWhiteBoard({type:n,netcallType:i,pushConfig:o})},t.prototype.initWhiteBoard=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=t.netcallType,o=t.pushConfig;this.type=n,this.netcallType=i||f.constantBB.CALL_TYPE_NONE,this.controller.setSessionConfig({signalStartTime:Date.now()});var r={type:this.serializeType(this.type,this.netcallType),accounts:[this.callee],pushConfig:o};return r.webrtcEnable=!0,this.nim.initWhiteBoard(r).then(function(t){e.signalInited=!0,e.sessionMode="p2p",e.logger.log("initWhiteBoard:",t),e.callerInfo=e.wbFormat(t),e.imInfo=e.callerInfo,e.imInfo.sessionMode=e.sessionMode,e.channelId=t.channelId,e.imInfo.role=0})["catch"](function(t){return e.controller.setSessionConfig({signalEndTime:Date.now()}),e.resetWhenHangup(),Promise.reject(t)})},t.prototype.response=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fn="wbCalleeAck",this.baseResponse(e)},t.prototype.control=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fn="wbControl",this.baseControl(e)},t.prototype.hangup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.fn="wbHangup",e.recordType="cancelWhiteBoardBeforeAccept",this.baseHangup(e)},t.prototype.createChannel=function(e){return e.channelName?(e.custom=e.custom||"",this.baseCreateChannel("wbCreateChannel",e).then(function(e){return Promise.resolve(e)})["catch"](function(e){return Promise.reject(e)})):Promise.reject("缺少参数 channelName")},t.prototype.joinChannel=function(e){var t=this;if(this.signalInited)return Promise.reject("已经加入房间");if(!e.channelName)return Promise.reject("缺少参数 channelName");var n=e.sessionConfig;return n&&(d.tool.merge(this,{sessionConfig:n}),this.controller.setSessionConfig(n),this.controller.setSessionConfig({signalStartTime:Date.now()})),this.baseJoinChannel("wbJoinChannel",{channelName:e.channelName}).then(function(i){var o=void 0;return i.turnInfoTag&&(o=i.turnInfoTag.dispatchServer&&JSON.parse(i.turnInfoTag.dispatchServer)||i.turnInfoTag.tunnelServer),o&&o.constructor===String&&(o=o.split(";")),o&&o.constructor===Object&&(o=o.webrtcarray),i.serverAddrs=o||[],t.type=i.type=i.type,i.account=t.nim.account,i.sessionConfig=n,t.imInfo=i,t.imInfo.role=void 0===e.role?0:e.role,setTimeout(function(){t.sessionStarted||t.startSession(e)},200),Promise.resolve({uid:i.uid,account:t.nim.account,type:i.type})})["catch"](function(e){return Promise.reject(e)})},t.prototype.onBeCalled=function(e){e=this.wbFormat(e),this.channelId||(this.signalInited=!0,this.channelId=e.channelId,this.beCalledInfo=e,this.logger.log("beCalling",e)),this.emit("beCalling",e)},t.prototype.wbFormat=function(e){var t=e,n=t.turnInfoTag;return n&&n.constructor===Array?(n.map(function(t){/[01]/.test(t.type)?(e.netcallType=t.type,e.rtcServerMap=t.dispatchServer,e.serverMap=JSON.parse(JSON.stringify(t.dispatchServer))):(e.type=t.type,e.wbServerMap=t.dispatchServer)}),e.netcallType=e.netcallType||f.constantBB.CALL_TYPE_NONE,e=this.format(e),e.serverAddrs=JSON.parse(JSON.stringify(e.wbServerMap))||[],e):e},t.prototype.resetWhenHangup=function(){this.controller.stopSession(),this.resetStatus(),this.sessionStarted=!1},t}(u["default"]),y=m.prototype;y=Object.assign(y,g["default"]),t["default"]=m,e.exports=t["default"]},256:function(e,t){"use strict";t.__esModule=!0,t["default"]=function(){return!!WebSocket},e.exports=t["default"]}})});