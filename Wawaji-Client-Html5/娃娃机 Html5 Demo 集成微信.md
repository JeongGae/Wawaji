# 微信网页第三方登录原理
## 微信开放平台和公众平台的区别

1. 公众平台面向的是普通的用户，比如自媒体和媒体，企业官方微信公众账号运营人员使用，当然你所在的团队或者公司有实力去开发一些内容，也可以调用公众平台里面的接口，比如自定义菜单，自动回复，查询功能。[公众平台链接地址](https://mp.weixin.qq.com)

2. 开放平台面向的开发者和第三方独立软件开发商。开放平台最大的开放就是微信登录。开发者或软件开发商，通过微信开放提供的平台和接口，可以开发适合企业的电子商务网站，扫描二维码进去一个游戏界面，然后去购买商品等。开放平台也开放了微信支付接口，那么类似口袋通这种软件开发厂商，就可以为大型，中小企业提供微信小店这种服务和软件了。[开放平台链接地址](https://open.weixin.qq.com)

## html5 娃娃机项目接入微信的本质

由上所述，公众平台就是服务号订阅号的管理开发后台。而开放平台就是可以实现将html5页面一键分享朋友圈，及获取用户登录信息的接口。

那么，一般开放者需要在微信公众号内接入html5抓娃娃机，需要执行三部分的操作：
1. 申请公众平台账号，并做相关配置，将底部自定义按钮的某些设置为链接，链接指向娃娃机html5网页。这部分文档不再赘述，参考[公众平台-自定义菜单](https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421141013)文档
2. 在娃娃机html5网页内，通过微信js-sdk，做一系列鉴权操作，获取微信登录用户的账户信息等，并将该信息抄送给娃娃机业务服务器后台。这部分文档不再赘述，参考[网站应用微信登录开发指南](https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&t=resource/res_list&verify=1&id=open1419316505&token=&lang=zh_CN)
3. 业务服务器后台得到相应的微信用户openid，在云信能力服务器调用接口创建云信登录帐号。这部分文档不再赘述，参考[云信帐号集成](http://dev.netease.im/docs/product/IM%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF/%E6%9C%8D%E5%8A%A1%E7%AB%AFAPI%E6%96%87%E6%A1%A3/%E7%BD%91%E6%98%93%E4%BA%91%E9%80%9A%E4%BF%A1ID)

## 接入流程图
``` graph
  用户     微信公众号      html5网页     微信开放平台    用户应用服务器    云信服务器
    ========> 点击 =========> 跳转
                            --------> 请求OAuth授权
    用户确认 <-------------------------------
    -------------------------------------->
                                          ----------> 开放平台票据抄送
                                     换取access_token <-------
                                        ---------------> 返回授权码
                                       获取微信个人信息 <------
                                       ---------------------->
                                                          -----------> 创建云信帐号
                                                        <------------------
                            初始化成功 <-------------------
                            ===========================================> 云信sdk连接
    =======================> 操作 <=======================================> 通信                
```